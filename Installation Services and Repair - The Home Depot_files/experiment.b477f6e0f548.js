(function(){(function(a){window.Experiment=function(b){this.options=b;this._registerAttempts=0;this._registerAttemptIntervalId=null;this.variation={};this.isOriginalVariationRunning=true;this.init=function(){var d=this,c=d._getQueryParam("show_variation"),e=d._getQueryParam("experiment");if(!d._hasOptions()){return}else{this._cleanExperimentName()}if((c||e)&&d.options.admin){if(e){d._pickVariation("original")}else{d._pickVariation(c)}}else{if(d._shouldRunExperiment()){d._pickVariation()}else{d._setOriginalVariation()}}d._register(d.options.name,d.variation.name);a(document).ready(function(){d._addBodyClass(d.options.name,d.variation.name)})};this._setOriginalVariation=function(){this.variation.name="original";this.variation.title="Original"};this._pickVariation=function(k){var d=this,h=d.options.variations,g=0,c=(h.length-1),j,f,e=false;if(k===undefined){j=d._getRandomInt(g,c);d.variation=h[j];d.isOriginalVariationRunning=false}else{if(k==="original"){d._setOriginalVariation()}else{for(f=0;f<d.options.variations.length;f++){if(d.options.variations[f].name===k){d.variation=d.options.variations[f];e=true;d.isOriginalVariationRunning=false}}if(!e){alert("Wrong variation name! Please check the url and enter a valid variation name. Defaulting back to original...");d._setOriginalVariation()}}d._showControlPanel()}};this._showControlPanel=function(){var c=this;a(document).ready(function(){var d=a("#tmpl-experiment-control-panel").html(),e=_.template(d,{experimentName:c.options.name,variations:c.options.variations,selectedVariation:c.variation});a("body").prepend(e);a("#experiment-control-panel .input-variation").on("change",function(){var f=window.location.origin+window.location.pathname+"?show_variation="+this.value;window.location.href=f})})};this._shouldRunExperiment=function(){var d=this,e=parseInt(Math.random()*100,10),c=parseInt(d.options.limit,10);if(e<=c){return true}else{return false}};this._hasOptions=function(){return this.options!==undefined&&this.options.limit!==undefined};this._cleanExperimentName=function(){var c=this,d=c.options.name;c.options.name=d.replace(/\W+/g,"-").toLowerCase()};this._extend=function(){for(var d=1;d<arguments.length;d++){for(var c in arguments[d]){if(arguments[d].hasOwnProperty(c)){arguments[0][c]=arguments[d][c]}}}return arguments[0]};this._addBodyClass=function(d,e){var c=document.body||document.getElementsByTagName("body");c.className+=" variation-"+e+" experiment-"+d};this._getRandomInt=function(d,c){return Math.floor(Math.random()*(c-d+1))+d};this._getQueryParam=function(c){var e=window.location.search.substring(1);var f=e.split("&");for(var d=0;d<f.length;d++){var g=f[d].split("=");if(g[0]===c){return g[1]}}return(false)};this._register=function(c,e){var d=this;if(window.mixpanel){mixpanel.register({experiment:c,variation:e});clearInterval(d._registerAttemptIntervalId)}else{if(d._registerAttempts<20){if(!d.attemptIntervalId){d._registerAttemptIntervalId=setInterval(function(){d._register(c,e)},1000)}d._registerAttempts++}else{clearInterval(d._registerAttemptIntervalId)}}};return this.init()}}(JQuery))}).call(this);